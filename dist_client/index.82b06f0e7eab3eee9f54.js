"use strict";(self.webpackChunkeasy_cms=self.webpackChunkeasy_cms||[]).push([[57],{62299:(e,t,s)=>{s.d(t,{_:()=>_s});const r="afterDomMounted",a="afterDomUpdated";class o{id;parent;pos;children;ref;render;afterDomMounted;afterDomUpdated;constructor(e,t,s,r){this.id=e,this.parent=t,this.pos=s,this.children=r,this.ref={current:null},this.afterDomMounted=[],this.afterDomUpdated=[]}lifeCycleRegister(e,t,s){switch(e){case r:this.afterDomMounted.push(t);break;case a:this.afterDomUpdated.push(t)}}lifeCycleRun(e){switch(e){case r:this.afterDomMounted.forEach((e=>e())),this.lifeCycleClear(e);break;case a:this.afterDomUpdated.forEach((e=>e()))}}lifeCycleClear(e){e===r&&(this.afterDomMounted.length=0)}}var n=s(96540),i=s(5338);const l=(0,n.createContext)({cNodeRoot:{}});var c=s(84976);const d="/preview",p=new class{render;canUndo;canRedo;constructor(){this.canUndo=!1,this.canRedo=!1}notify(e,t){let s=0!==e,r=0!==t;s===this.canUndo&&r===this.canRedo||(this.canUndo=s,this.canRedo=r,this.render())}},m=new class{id;constructor(){this.id=-1}get(){return this.id}gene(){return++this.id,this.id}},h="add",u="re_add",f="copy",g="move",v="delete",N={[h]:class{parentId;componentName;pos;type;id;constructor(e,t,s){this.parentId=e,this.componentName=t,this.pos=s,this.type=h,this.id=String(m.gene())}},[u]:class{id;parentId;pos;type;constructor(e,t,s){this.id=e,this.parentId=t,this.pos=s,this.type=u}},[f]:class{copyId;parentId;pos;type;id;constructor(e,t,s){this.copyId=e,this.parentId=t,this.pos=s,this.type=f,this.id=String(m.gene())}},[g]:class{id;moveFromParentId;moveFromPos;moveToParentId;moveToPos;type;constructor(e,t,s,r,a){this.id=e,this.moveFromParentId=t,this.moveFromPos=s,this.moveToParentId=r,this.moveToPos=a,this.type=g}},[v]:class{id;prevParentId;pos;type;constructor(e,t,s){this.id=e,this.prevParentId=t,this.pos=s,this.type=v}}},b=new class{undoStack;redoStack;constructor(){this.undoStack=[],this.redoStack=[]}createActionCNode(e){let t;switch(e.type){case h:t=new N[e.type](e.parentId,e.componentName,e.pos);break;case f:t=new N[e.type](e.copyId,e.parentId,e.pos);break;case g:t=new N[e.type](e.id,e.moveFromParentId,e.moveFromPos,e.moveToParentId,e.moveToPos);break;case v:t=new N[e.type](e.id,e.prevParentId,e.pos);break;default:throw"createActionCNode失败"}return t}createActionCNode_reverse(e){let t;switch(e.type){case h:case u:case f:t=new N[v](e.id,e.parentId,e.pos);break;case g:t=new N[g](e.id,e.moveToParentId,e.moveToPos,e.moveFromParentId,e.moveFromPos);break;case v:t=new N[u](e.id,e.prevParentId,e.pos);break;default:throw"createActionCNode_reverse失败"}return t}do(e){const t=this.createActionCNode(e);return this.undoStack.push(t),this.redoStack.length=0,t}getUndoStackSize(){return this.undoStack.length}getRedoStackSize(){return this.redoStack.length}undo(){if(0===this.undoStack.length)return null;const e=this.undoStack.pop(),t=this.createActionCNode_reverse(e);return this.redoStack.push(t),t}redo(){if(0===this.redoStack.length)return null;const e=this.redoStack.pop(),t=this.createActionCNode_reverse(e);return this.undoStack.push(t),t}},y="select",E="select_none",w="select_update",C="drag_start",x="dropTarget_update",_="dropTarget_none",k={[y]:class{id;type;constructor(e){this.id=e,this.type=y}},[E]:class{type;constructor(){this.type=E}},[w]:class{type;constructor(){this.type=w}},[C]:class{componentName;componentCategory;type;constructor(e,t){this.componentName=e,this.componentCategory=t,this.type=C}},[x]:class{id;type;constructor(e){this.id=e,this.type=x}},[_]:class{type;constructor(){this.type=_}}},D=new class{constructor(){}createActionTip(e){let t={};switch(e.type){case y:t=new k[e.type](e.id);break;case E:case w:t=new k[e.type];break;case C:t=new k[e.type](e.componentName,e.componentCategory);break;case x:t=new k[e.type](e.id);break;case _:t=new k[e.type];break;default:throw"createActionTip失败"}return t}},S="props_update",T={[S]:class{id;prop;value;type;constructor(e,t,s){this.id=e,this.prop=t,this.value=s,this.type=S}}},z=new class{constructor(){}createActionCNodeProps(e){let t={};if(e.type!==S)throw"createActionCNodeProps失败";return t=new T[e.type](e.id,e.prop,e.value),t}},A="css_style_update",I={[A]:class{id;cssStyle;type;constructor(e,t){this.id=e,this.cssStyle=t,this.type=A}}},P=new class{constructor(){}createActionCNodeCssStyle(e){let t={};if(e.type!==A)throw"createActionCNodeCssStyle失败";return t=new I[e.type](e.id,e.cssStyle),t}},R=new class{constructor(){}transferActionCNode(e){_s.receiveActionCNode(e),this.notifyTimeTravel()}transferActionTip(e){_s.receiveActionTip(e)}transferActionCNodeProps(e){_s.receiveActionCNodeProps(e)}transferActionCNodeCssStyle(e){_s.receiveActionCNodeCssStyle(e)}notifyTimeTravel(){p.notify(b.getUndoStackSize(),b.getRedoStackSize())}dispatchAction(e){let t={};!function(e){return e.type in N}(e)?function(e){return e.type in k}(e)?(t=D.createActionTip(e),this.transferActionTip(t)):function(e){return e.type in T}(e)?(t=z.createActionCNodeProps(e),this.transferActionCNodeProps(t)):function(e){return e.type in I}(e)&&(t=P.createActionCNodeCssStyle(e),this.transferActionCNodeCssStyle(t)):(t=b.do(e),this.transferActionCNode(t))}dispatchUndo(){const e=b.undo();e&&this.transferActionCNode(e)}dispatchRedo(){const e=b.redo();e&&this.transferActionCNode(e)}};var L=s(33362),M=s(22732),V=s(34164),F=s(50856);function U(...e){return(0,F.QP)((0,V.$)(e))}function O(e){const t=new Map;return function e(s){let r=null;if(Array.isArray(s)){if(t.has(s))return s;r=[],t.set(s,r),s.forEach(((t,s)=>{r[s]=e(t)}))}else if("object"==typeof s&&null!==s){if(t.has(s))return s;r={},t.set(s,r),Object.getOwnPropertyNames(s).forEach((t=>{r[t]=e(s[t])})),Object.getOwnPropertySymbols(s).forEach((t=>{let a=Symbol.keyFor(t);void 0!==a?r[Symbol.for(a)]=e(s[t]):(a=t.description,r[Symbol(a)]=e(s[t]))}))}else if("symbol"==typeof s){let e=Symbol.keyFor(s);r=void 0!==e?Symbol.for(e):Symbol(e)}else r=s;return r}(e)}let H=0;function B(e,t){H++,t||(t="error");let s=0,r=1;const a=e=>{0===s&&(s=e);const t=e-s;let o=0;if(o=1===r?Math.min(1.1*t,110):Math.max(110-1.1*t,0),n.style.transform=`translateY(${o}px)`,t>=100)return s=0,void(1===r?(r=2,setTimeout((()=>{window.requestAnimationFrame(a)}),3e3)):setTimeout((()=>{document.body.removeChild(n)}),100));window.requestAnimationFrame(a)},o=[["position","absolute"],["zIndex","999"],["width","300px"],["height","80px"],["top","-80px"],["left","0px"],["right","0px"],["margin","0px auto"],["padding","1rem"],["borderRadius","calc(var(--radius) - 2px)"],["wordBreak","break-all"],["border","1px solid transparent"]];switch(t){case"error":o.push(["backgroundColor","hsl(var(--destructive))"],["color","hsl(var(--destructive-foreground))"],["borderColor","hsl(var(--destructive))"]);break;case"info":o.push(["backgroundColor","var(--toast_dom_info)"],["color","var(--s900)"],["borderColor","var(--toast_dom_info)"])}const n=document.createElement("div");n.id=`toast_dom-${H}`,o.forEach((([e,t])=>{n.style[e]=t}));const i=document.createElement("div");i.textContent=e,[["height","100%"],["display","flex"],["justifyContent","center"],["alignItems","center"],["overflowY","hidden"]].forEach((([e,t])=>{i.style[e]=t})),n.appendChild(i),document.body.appendChild(n),window.requestAnimationFrame(a)}const j=(0,M.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline","CNodeSticker-tool":"bg-transparent hover:bg-s50",TimeTravel:"bg-transparent hover:bg-s200",noBackground:""},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10","CNodeSticker-tool":"h-[32px] w-[32px] mr-[8px] last:mr-0 flex justify-center items-center",TimeTravel:"w-[50px] h-[50px] mr-[4px] text-center",noSize:"bg-[initial] hover:bg-[initial]"}},defaultVariants:{variant:"default",size:"default"}}),J=n.forwardRef((({className:e,variant:t,size:s,asChild:r=!1,...a},o)=>{const i=r?L.DX:"button";return n.createElement(i,{className:U(j({variant:t,size:s,className:e})),ref:o,...a})}));function $(){const[e,t]=(0,n.useState)(0);(0,n.useEffect)((()=>{p.render=()=>t((e=>e+1))}),[]);const s=(0,n.useCallback)((()=>{R.dispatchAction({type:E}),R.dispatchUndo()}),[]),r=(0,n.useCallback)((()=>{R.dispatchAction({type:E}),R.dispatchRedo()}),[]),{canUndo:a,canRedo:o}=p;return n.createElement("div",{className:"flex items-center"},n.createElement(J,{onClick:a?s:void 0,variant:"TimeTravel",size:"TimeTravel",style:a?{cursor:"pointer"}:{cursor:"not-allowed",opacity:"0.5"}},n.createElement("svg",{className:"icon_TimeTravel_UI",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1783",width:"32",height:"32"},n.createElement("path",{d:"M452.266667 413.866667V305.066667a25.173333 25.173333 0 0 0-40.106667-20.906667L145.066667 469.333333a25.6 25.6 0 0 0 0 42.666667l267.093333 186.453333a25.6 25.6 0 0 0 40.106667-21.333333V610.133333a25.6 25.6 0 0 1 26.88-25.6 341.333333 341.333333 0 0 1 301.653333 263.68 336.64 336.64 0 0 0-304.213333-409.173333 25.173333 25.173333 0 0 1-24.32-25.173333z",fill:"currentColor","p-id":"1784"}))),n.createElement(J,{onClick:o?r:void 0,variant:"TimeTravel",size:"TimeTravel",style:o?{cursor:"pointer"}:{cursor:"not-allowed",opacity:"0.5"}},n.createElement("svg",{className:"icon_TimeTravel_UI",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2057",width:"32",height:"32"},n.createElement("path",{d:"M512 371.2V261.973333a25.6 25.6 0 0 1 40.106667-20.906666L819.2 426.666667a25.6 25.6 0 0 1 0 42.666666l-267.093333 186.453334a25.6 25.6 0 0 1-40.106667-20.906667V567.466667a25.173333 25.173333 0 0 0-26.88-25.6 341.333333 341.333333 0 0 0-301.653333 263.68 336.64 336.64 0 0 1 304.64-409.173334 25.173333 25.173333 0 0 0 23.893333-25.173333z",fill:"currentColor","p-id":"2058"}))))}J.displayName="Button";const K="cNodeTree_hash",W="cNodeTree_hash_birth";function Y(e){return!(+new Date-e>864e5)}const Z=new class{constructor(){}async preview(){try{const{cNodeTree_JSON:e,cNodeTree_hash:t}=await _s.getCNodeTreeJSON(),s=localStorage.getItem(K),r=localStorage.getItem(W);if(s&&r)if(Y(+r)){if(t===s)return!0}else localStorage.removeItem(K),localStorage.removeItem(W);return!0}catch(e){return console.log("preview出错 -> "+e),!1}}async codeGen(e){return await async function(e){try{const{success:t,data:s,errMsg:r}=await async function(e,t){let s={success:!1,data:null,errMsg:""};const r=new AbortController;t||(t={}),t.signal=r.signal;let a=null,o=3e4,n="超时30s";void 0!==t.timeout&&(o=t.timeout,t.errMsg_Timeout&&(n=t.errMsg_Timeout)),0!==o&&(a=setTimeout((()=>{r.abort(n)}),o));try{const e=await fetch("/api/landingCode_gen",t);if(s=await e.json(),!e.ok||!s.success)throw s.errMsg}catch(e){console.log("api请求失败兜底: ",e),t.toast&&B(""+e)}finally{null!==a&&clearTimeout(a)}return console.log("看下最终的result_api todo",s),s}(0,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),timeout:3e5,errMsg_Timeout:"超时5分钟"});if(!t)throw r;return s}catch(e){return console.log("landingCode_gen_req出错 -> "+e),null}}(e)}},q="UNDO",G="DOING",X="SUCCESS",Q="FAIL",ee={[q]:null,[G]:"生成中，请稍后",[X]:"点击查看",[Q]:"出错啦"};class te{render;worker;state;cNodeTree_JSON;cNodeTree_hash;region;data;Dialog_show;tip_Icon_show;tip_Icon_active;tip_text_show;tip_text;firstOpen;tip_text_loading_first;disabledBtnDownloadZip;constructor(){this.worker=null,this.state=q,this.cNodeTree_JSON=null,this.cNodeTree_hash=null,this.region={RegionHeader:!0,RegionSideMenuBar:!0},this.data=null,this.Dialog_show=!1,this.tip_Icon_show=!1,this.tip_Icon_active=!1,this.tip_text_show=!1,this.tip_text=ee[this.state],this.firstOpen=!1,this.tip_text_loading_first=null,this.disabledBtnDownloadZip=!1}async codeGen(){if(this.state=G,this.render(),!this.cNodeTree_JSON||!this.cNodeTree_hash){const{cNodeTree_JSON:e,cNodeTree_hash:t}=await _s.getCNodeTreeJSON();this.cNodeTree_JSON=e,this.cNodeTree_hash=t}const e=await Z.codeGen({cNodeTree_JSON:this.cNodeTree_JSON,cNodeTree_hash:this.cNodeTree_hash,region:this.region});this.codeGen_after(e)}codeGen_after(e){this.cNodeTree_JSON=null,this.cNodeTree_hash=null,e?(this.state=X,this.data=e):this.state=Q,this.tip_text=ee[this.state],this.Dialog_show?(this.tip_Icon_active=!1,this.tip_text_show=!1):(this.tip_Icon_active=!0,this.tip_text_show=!0),null!==this.tip_text_loading_first&&(clearTimeout(this.tip_text_loading_first),this.tip_text_loading_first=null),this.render()}open(){this.firstOpen=!0,this.Dialog_show=!0,this.tip_Icon_show=!0,this.tip_Icon_active=!1,this.tip_text_show=!1,this.render()}close(){this.Dialog_show=!1,this.firstOpen&&(this.firstOpen=!1,this.state===G&&(this.tip_text_show=!0,this.tip_text=ee[this.state],this.tip_text_loading_first=setTimeout((()=>{null!==this.tip_text_loading_first&&(this.tip_text_show=!1,this.render())}),3e3))),this.render()}setRegion(e,t){this.region[e]=t,this.render()}getAssets(){this.state!==q&&(this.Dialog_show=!0,this.state!==X&&this.state!==Q||(this.tip_Icon_active&&(this.tip_Icon_active=!1),this.tip_text_show&&(this.tip_text_show=!1)),this.render())}async downloadAssets(){this.data&&(this.initWorker(),this.disabledBtnDownloadZip=!0,this.render(),this.worker_send({type:"zip_download",downloadUrl_manifest:this.data.downloadUrl_manifest}))}initWorker(){null===this.worker&&(this.worker=new Worker(new URL(s.p+s.u(113),s.b),{name:te.name,type:void 0}),this.worker.onmessage=({data:e})=>{this.worker_revieve(e)})}worker_revieve(e){switch(e.type){case"zip_success":const{zip:t}=e;!function(e,t){const s=document.createElement("a"),r=window.URL.createObjectURL(t);s.download="project.zip",s.href=r,s.click(),window.URL.revokeObjectURL(r),s.remove()}(0,new Blob([t])),this.worker_send({type:"zip_saved"}),this.disabledBtnDownloadZip=!1,this.render();break;case"zip_fail":B("下载zip文件失败"),this.disabledBtnDownloadZip=!1,this.render()}}worker_send(e){this.worker.postMessage(e)}}const se=new te;var re=s(60990),ae=s(48697);const oe=re.bL,ne=(re.l9,re.ZL),ie=(re.bm,n.forwardRef((({className:e,...t},s)=>n.createElement(re.hJ,{ref:s,className:U("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}))));ie.displayName=re.hJ.displayName;const le=n.forwardRef((({className:e,children:t,...s},r)=>n.createElement(ne,null,n.createElement(ie,null),n.createElement(re.UC,{ref:r,className:U("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s},t,n.createElement(re.bm,{onClick:s.onClose,className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground"},n.createElement(ae.A,{className:"h-4 w-4"}),n.createElement("span",{className:"sr-only"},"Close"))))));le.displayName=re.UC.displayName;const ce=({className:e,...t})=>n.createElement("div",{className:U("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});ce.displayName="DialogHeader";const de=n.forwardRef((({className:e,...t},s)=>n.createElement(re.hE,{ref:s,className:U("text-lg font-semibold leading-none tracking-tight",e),...t})));de.displayName=re.hE.displayName,n.forwardRef((({className:e,...t},s)=>n.createElement(re.VY,{ref:s,className:U("text-sm text-muted-foreground",e),...t}))).displayName=re.VY.displayName;var pe=s(3881);const me=pe.Kq,he=pe.bL,ue=pe.l9,fe=n.forwardRef((({className:e,sideOffset:t=4,...s},r)=>n.createElement(pe.UC,{ref:r,sideOffset:t,className:U("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})));fe.displayName=pe.UC.displayName;var ge=s(92731),ve=s(45773);const Ne=n.forwardRef((({className:e,...t},s)=>n.createElement(ge.bL,{ref:s,className:U("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t},n.createElement(ge.C1,{className:U("flex items-center justify-center text-current")},n.createElement(ve.A,{className:"h-4 w-4"})))));Ne.displayName=ge.bL.displayName;var be=s(74353),ye=s.n(be);const Ee={[q]:"生成代码",[G]:"生成中",[X]:"生成代码",[Q]:"生成代码"},we={[q]:null,[G]:n.createElement("svg",{className:"Icon_tip_codeGen doing",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5487",width:"32",height:"32"},n.createElement("path",{d:"M540.444 272.782a129.138 129.138 0 1 1 129.138-129.138 129.138 129.138 0 0 1-129.138 129.138z",fill:"#2A83C6","p-id":"5488"}),n.createElement("path",{d:"M265.387 375.182a118.044 118.044 0 1 1 117.76-117.76 117.76 117.76 0 0 1-117.76 117.76z",fill:"#2C8CCD","p-id":"5489"}),n.createElement("path",{d:"M148.764 641.991A104.107 104.107 0 1 1 252.587 538.17a104.107 104.107 0 0 1-103.823 103.82z",fill:"#4299D5","p-id":"5490"}),n.createElement("path",{d:"M265.387 906.24a88.178 88.178 0 1 1 88.177-88.178 88.178 88.178 0 0 1-88.177 88.178z",fill:"#58A4DB","p-id":"5491"}),n.createElement("path",{d:"M540.444 1007.218a77.084 77.084 0 1 1 76.8-77.085 77.084 77.084 0 0 1-76.8 77.085z",fill:"#6EB1E2","p-id":"5492"}),n.createElement("path",{d:"M818.916 877.227a62.293 62.293 0 1 1 62.862-62.294 62.293 62.293 0 0 1-62.294 62.294z",fill:"#84BDE7","p-id":"5493"}),n.createElement("path",{d:"M933.262 589.653a51.2 51.2 0 1 1 50.916-51.2 51.2 51.2 0 0 1-50.916 51.2z",fill:"#9BCAED","p-id":"5494"}),n.createElement("path",{d:"M779.378 261.12a39.822 39.822 0 1 0 39.538-39.538 39.822 39.822 0 0 0-39.538 39.538z",fill:"#B3D7F2","p-id":"5495"})),[X]:n.createElement("svg",{className:"Icon_tip_codeGen success",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7526",width:"32",height:"32"},n.createElement("path",{d:"M512 0C230.4 0 0 230.4 0 512c0 281.6 230.4 512 512 512 281.6 0 512-230.4 512-512C1024 230.4 793.6 0 512 0zM512 960c-249.6 0-448-204.8-448-448 0-249.6 204.8-448 448-448 249.6 0 448 198.4 448 448C960 761.6 761.6 960 512 960zM691.2 339.2 454.4 576 332.8 454.4c-19.2-19.2-51.2-19.2-76.8 0C243.2 480 243.2 512 262.4 531.2l153.6 153.6c19.2 19.2 51.2 19.2 70.4 0l51.2-51.2 224-224c19.2-19.2 25.6-51.2 0-70.4C742.4 320 710.4 320 691.2 339.2z",fill:"#54E283","p-id":"7527"})),[Q]:n.createElement("svg",{className:"Icon_tip_codeGen fail",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7530",width:"32",height:"32"},n.createElement("path",{d:"M969.182003 701.303054C942.98583 761.818425 907.560805 814.394635 862.909139 859.030351 818.273423 903.682017 765.86402 939.121773 705.727336 965.303215 645.576031 991.515341 581.182839 1004.606061 512.545547 1004.606061 443.925315 1004.606061 379.349482 991.515341 318.818158 965.303215 258.302785 939.121773 205.726577 903.682017 161.090861 859.030351 116.439196 814.393527 80.999438 761.818425 54.817996 701.303054 28.605873 640.772838 15.515152 576.197117 15.515152 507.575665 15.515152 438.938373 28.605873 374.545181 54.817996 314.393878 80.999438 254.257304 116.439196 201.8479 161.090861 157.212073 205.726577 112.560409 258.302785 77.135381 318.818158 50.939208 379.349482 24.743034 443.925203 11.636364 512.545547 11.636364 581.182839 11.636364 645.576031 24.742924 705.727336 50.939208 765.8628 77.1366 818.273311 112.560409 862.909139 157.212073 907.560805 201.848897 942.984611 254.258412 969.182003 314.393878 995.378179 374.545181 1008.484848 438.938373 1008.484848 507.575665 1008.484848 576.197117 995.379287 640.772838 969.182003 701.303054L969.182003 701.303054Z",fill:"#FF2E00","p-id":"7531"}),n.createElement("path",{d:"M512 709.220647C472.332325 709.220647 440.203301 741.349668 440.203301 781.017346 440.203301 820.68502 472.332325 852.814044 512 852.814044 551.667675 852.814044 583.796699 820.68502 583.796699 781.017346 583.796699 741.349668 551.667675 709.220647 512 709.220647L512 709.220647Z",fill:"#FFFFFF","p-id":"7532"}),n.createElement("path",{d:"M512 639.709091C492.184111 639.709091 476.101651 606.196596 476.101651 564.820837L440.203301 227.823683C440.203301 186.447921 472.332325 152.935427 512 152.935427 551.667675 152.935427 583.796699 186.447921 583.796699 227.823683L547.898349 564.820837C547.898349 606.196596 531.815889 639.709091 512 639.709091L512 639.709091Z",fill:"#FFFFFF","p-id":"7533"}))},Ce={[q]:"开始",[G]:"生成中",[X]:"开始",[Q]:"再试一次"};function xe(){const[e,t]=(0,n.useState)(0);(0,n.useEffect)((()=>{se.render=()=>t((e=>e+1))}),[]);const s=(0,n.useCallback)((()=>{se.open()}),[]),r=(0,n.useCallback)((()=>{se.close()}),[]),a=(0,n.useCallback)((()=>{se.getAssets()}),[]),{state:o,Dialog_show:i,tip_Icon_show:l,tip_Icon_active:c,tip_text_show:d,tip_text:p}=se;return n.createElement(oe,{open:i},n.createElement("div",{className:"flex"},n.createElement(J,{className:"w-[90px] text-center",disabled:o===G,onClick:s},Ee[o]),n.createElement("div",{className:"w-[40px] flex justify-center pageParts-center",onClick:a},l&&n.createElement(me,null,n.createElement(he,{open:d},n.createElement(ue,{asChild:!0},n.createElement(J,{variant:"noBackground",size:"noSize",className:c?"active":""},we[o])),n.createElement(fe,null,p))))),n.createElement(le,{className:"sm:max-w-[520px]",onClose:r},n.createElement(ce,null,n.createElement(de,null,"配置页面结构")),n.createElement(_e,null)))}function _e(){return n.createElement("div",null,n.createElement(De,null),n.createElement(Te,null))}const ke={RegionHeader:"顶部导航栏",RegionSideMenuBar:"侧边栏"};function De(){const e=(0,n.useCallback)((()=>{se.codeGen()}),[]),t=(0,n.useCallback)((e=>()=>{se.setRegion(e,!r[e])}),[]),{state:s,region:r}=se;return n.createElement("div",{className:"flex flex-nowrap"},n.createElement("div",{className:"flex-grow flex-shrink flex flex-col justify-between"},Object.keys(r).map((e=>n.createElement("div",{key:e,className:"flex items-center space-x-2 mt-[8px]"},n.createElement(Ne,{disabled:s===G,checked:r[e],onClick:t(e)}),n.createElement("label",{htmlFor:"terms",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},ke[e]))))),n.createElement("div",{className:"flex-grow-0 flex-shrink-0 basis-[80px] flex justify-end"},n.createElement(J,{type:"submit",disabled:s===G,onClick:e},Ce[s])))}const Se={[q]:"暂无资源生成",[G]:"正在生成代码文件资源...",[X]:e=>`资源截止到${ye()(e+864e5).format("YYYY-MM-DD HH:mm:ss")}失效，请及时下载`,[Q]:"生成代码失败，请咨询管理员"};function Te(){const e=(0,n.useCallback)((()=>{se.downloadAssets()}),[]),{state:t,data:s,disabledBtnDownloadZip:r}=se;return n.createElement("div",{className:"mt-[20px]"},n.createElement("div",{className:"mb-[10px]"},t===X?Se[X](s?s.birthtimeMs:0):Se[t]),n.createElement("div",{className:"flex justify-end"},t===X&&n.createElement(J,{type:"submit",disabled:r,onClick:e},"下载文件包zip")))}function ze(){const[e,t]=(0,n.useState)(!1);return(0,n.useCallback)((async()=>{t(!0);let e=await Z.preview();t(!1),e?window.open(d):B("预览失败")}),[]),n.createElement("div",{className:"flex items-center"},n.createElement(xe,null))}function Ae(){return n.createElement("div",{id:"header",className:U("h-[60px] grow-0 shrink-0 flex justify-around bg-secondary relative z-20")},n.createElement("div",{className:"flex-grow-[2] basis-0 flex items-center"}),n.createElement("div",{className:"flex-grow-[3] basis-0 flex items-center justify-center"},n.createElement($,null)),n.createElement("div",{className:"flex-grow-[2] basis-0 flex items-center"},n.createElement(ze,null)))}const Ie="form",Pe={fieldKey:"fieldKey",fieldLabel:"fieldLabel",fieldPlaceholder:"fieldPlaceholder"},Re={componentName:"FileUpload",title:"文件上传"},Le=Object.assign({},Pe),Me={componentName:"Input",title:"输入框"},Ve=Object.assign({},Pe),Fe={componentName:"Select",title:"下拉选择框"},Ue=Object.assign({},Pe),Oe={componentName:"FormBlock",title:"表单块"},He="widthRadio",Be="widthRadio_prev",je="columnNum",Je="columnNum_prev",$e="regionName",Ke={[He]:[{value:"100%",text:"100%"},{value:"50%",text:"50%"}],[je]:[{value:"1",text:"一栏"},{value:"2",text:"两栏"},{value:"3",text:"三栏"},{value:"4",text:"四栏"}]},We="layout",Ye=[{componentCategory:We,title:"布局类",components:[{...Oe}]},{componentCategory:Ie,title:"表单类",components:[{...Me},{...Fe},{...Re}]}];var Ze=s(835),qe=s(75107);const Ge=Ze.bL,Xe=n.forwardRef((({className:e,...t},s)=>n.createElement(Ze.q7,{ref:s,className:U("border-b",e),...t})));Xe.displayName="AccordionItem";const Qe=n.forwardRef((({className:e,children:t,...s},r)=>n.createElement(Ze.Y9,{className:"flex"},n.createElement(Ze.l9,{ref:r,className:U("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...s},t,n.createElement(qe.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})))));Qe.displayName=Ze.l9.displayName;const et=n.forwardRef((({className:e,children:t,...s},r)=>n.createElement(Ze.UC,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down mb-2",...s},n.createElement("div",{className:U("pb-2 pt-2",e)},t))));et.displayName=Ze.UC.displayName;const tt="Root",st={[tt]:()=>n.createElement("svg",{className:"Icon_CNode_UI_Left",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"15515",id:"mx_n_1723196036822",width:"32",height:"32"},n.createElement("path",{d:"M513.6 417.1c41.5-23 83.2-45.6 124.6-69 14.6-8.3 26.5-7.4 38.8 4.6 17.4 16.9 37.6 29.7 60.5 38.1 112.8 41.2 235.6-54.1 223.7-173.5-9.9-99-99.7-169.2-196.2-153.4C673 79 611.4 167.2 627.7 260.7c4.4 25.4 3.1 28.1-19.6 40.6-39.2 21.7-78.4 43.3-117.6 64.9-21.2 11.7-26.3 10.9-42.7-6.8-62.5-67.5-159.4-89.9-245-56.6-84.6 32.9-140.4 115-140.4 206.6 0 101.9 67.3 190.5 165.9 215.2 78.8 19.8 148.8 0.2 209-54.1 11.1-10 21.1-15.5 35.3-6.2 46.8 30.8 93.8 61.2 140.7 91.7 13.8 9 18.4 21.2 15.1 37.1-2.7 13-4.7 26.3-3.4 39.7 7.5 80.1 72.3 134.5 154.6 127.5 52.4-4.5 92-31.5 113.3-79.7 20.9-47.3 19-95.1-11.7-138.4-45.3-63.9-124.9-80.1-190.9-37.5-21.6 13.9-36.9 12.8-57.2-1.5-41.8-29.5-85.2-56.8-128.5-84.1-14.3-9-18-18.6-11.7-34.4 17-43 18.8-87.1 6.1-131.7-6.4-21.6-4.7-25.2 14.6-35.9z m280.1-298c62.4 0.5 111.6 50.1 111.5 112.2-0.1 62.5-49.2 111.4-111.9 111.4-63.2 0.1-113-49.7-112.6-112.6 0.4-61.6 51.2-111.5 113-111z m-28.1 618.6c46 0.8 84.7 40.2 84 85.6-0.7 45.1-39.6 82.8-85 82.4-46.5-0.4-84.5-39-83.8-85.1 0.7-44.9 40.4-83.7 84.8-82.9z",fill:"currentColor","p-id":"15516"})),[Oe.componentName]:()=>n.createElement("svg",{className:"Icon_CNode_UI_Left",viewBox:"0 0 2048 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8867",width:"32",height:"32"},n.createElement("path",{d:"M2048 32v44.501333h-21.333333V32a10.666667 10.666667 0 0 0-10.666667-10.666667H2005.333333V0h10.666667A32 32 0 0 1 2048 32z m0 87.168v85.333333h-21.333333v-85.333333h21.333333z m0 128v85.333333h-21.333333v-85.333333h21.333333z m0 128v85.333333h-21.333333v-85.333333h21.333333z m0 128v85.333333h-21.333333v-85.333333h21.333333z m0 128v85.333333h-21.333333v-85.333333h21.333333z m0 128v85.333333h-21.333333v-85.333333h21.333333z m0 128v85.333333h-21.333333v-85.333333h21.333333zM2022.997333 1024h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-128 0h-85.333333v-21.333333h85.333333v21.333333z m-204.458666-0.469333l-10.517334-1.813334 3.626667-21.013333 10.517333 1.813333A10.794667 10.794667 0 0 0 32 1002.666667h70.997333v21.333333H32c-1.834667 0-3.669333-0.149333-5.461333-0.469333zM0 965.184v-85.333333h21.333333v85.333333H0z m0-128v-85.333333h21.333333v85.333333H0z m0-128v-85.333333h21.333333v85.333333H0z m0-128v-85.333333h21.333333v85.333333H0z m0-128v-85.333333h21.333333v85.333333H0z m0-128v-85.333333h21.333333v85.333333H0z m0-128v-85.333333h21.333333v85.333333H0zM32 0h17.984v21.333333H32a10.666667 10.666667 0 0 0-10.666667 10.666667v37.184H0V32A32 32 0 0 1 32 0z m60.650667 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z m128 0h85.333333v21.333333h-85.333333V0z",fill:"currentColor","p-id":"8868"}),n.createElement("path",{d:"M559.530667 149.333333v725.333334H170.666667V149.333333h388.864zM991.573333 149.333333v725.333334H602.730667V149.333333h388.864z m432.064 0v725.333334H1034.794667V149.333333h388.864zM1877.333333 149.333333v725.333334H1466.88V149.333333H1877.333333z",fill:"currentColor","p-id":"8869"})),[Me.componentName]:()=>n.createElement("svg",{className:"Icon_CNode_UI_Left",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4495",width:"32",height:"32"},n.createElement("path",{d:"M896 224H128c-35.2 0-64 28.8-64 64v448c0 35.2 28.8 64 64 64h768c35.2 0 64-28.8 64-64V288c0-35.2-28.8-64-64-64z m0 480c0 19.2-12.8 32-32 32H160c-19.2 0-32-12.8-32-32V320c0-19.2 12.8-32 32-32h704c19.2 0 32 12.8 32 32v384z",fill:"#333333","p-id":"4496"}),n.createElement("path",{d:"M224 352c-19.2 0-32 12.8-32 32v256c0 16 12.8 32 32 32s32-12.8 32-32V384c0-16-12.8-32-32-32z",fill:"currentColor","p-id":"4497"})),[Fe.componentName]:()=>n.createElement("svg",{className:"Icon_CNode_UI_Left",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4495",width:"32",height:"32"},n.createElement("path",{d:"M896 64H128c-35.2 0-64 28.8-64 64v96c0 35.2 28.8 64 64 64h768c35.2 0 64-28.8 64-64v-96c0-35.2-28.8-64-64-64z m0 144c0 9.6-6.4 16-16 16H144c-9.6 0-16-6.4-16-16v-64c0-9.6 6.4-16 16-16h736c9.6 0 16 6.4 16 16v64zM768 320H128c-35.2 0-64 28.8-64 64v512c0 35.2 28.8 64 64 64h640c35.2 0 64-28.8 64-64V384c0-35.2-28.8-64-64-64z m0 544c0 19.2-16 32-32 32H160c-16 0-32-12.8-32-32V416c0-19.2 16-32 32-32h576c16 0 32 12.8 32 32v448z",fill:"currentColor","p-id":"4496"}),n.createElement("path",{d:"M656 736H240c-9.6 0-16 6.4-16 16v32c0 9.6 6.4 16 16 16h416c9.6 0 16-6.4 16-16v-32c0-9.6-6.4-16-16-16z m0-256H240c-9.6 0-16 6.4-16 16v32c0 9.6 6.4 16 16 16h416c9.6 0 16-6.4 16-16v-32c0-9.6-6.4-16-16-16z m0 128H240c-9.6 0-16 6.4-16 16v32c0 9.6 6.4 16 16 16h416c9.6 0 16-6.4 16-16v-32c0-9.6-6.4-16-16-16z",fill:"currentColor","p-id":"4497"})),[Re.componentName]:()=>n.createElement("svg",{className:"Icon_CNode_UI_Left",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4730",width:"32",height:"32"},n.createElement("path",{d:"M793.6 358.4C768 227.2 652.8 128 512 128s-256 99.2-281.6 230.4C134.4 384 64 473.6 64 576c0 124.8 99.2 224 224 224h32v-64h-32c-89.6 0-160-70.4-160-160s70.4-160 160-160c0-124.8 99.2-224 224-224s224 99.2 224 224c89.6 0 160 70.4 160 160s-70.4 160-160 160h-32v64h32c124.8 0 224-99.2 224-224 0-102.4-70.4-192-166.4-217.6z",fill:"currentColor","p-id":"4731"}),n.createElement("path",{d:"M540.8 489.6c-12.8-9.6-25.6-12.8-38.4-6.4-3.2 0-6.4 3.2-9.6 6.4l-96 92.8c-12.8 12.8-12.8 32 0 44.8 12.8 12.8 35.2 12.8 48 0l38.4-35.2v272c0 19.2 16 32 32 32 19.2 0 32-16 32-32V592l38.4 35.2c12.8 12.8 35.2 12.8 48 0 12.8-12.8 12.8-32 0-44.8l-92.8-92.8z",fill:"currentColor","p-id":"4732"}))},rt=[{type:"CNodeDragLeft",Icon:()=>n.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4274",width:"32",height:"32"},n.createElement("path",{d:"M768 928H128a32 32 0 0 1-32-32V256a32 32 0 0 1 32-32h195.84A132.48 132.48 0 0 1 320 192a128 128 0 0 1 256 0 132.48 132.48 0 0 1-3.84 32H768a32 32 0 0 1 32 32v195.84A132.48 132.48 0 0 1 832 448a128 128 0 0 1 0 256 132.48 132.48 0 0 1-32-3.84V896a32 32 0 0 1-32 32z m-608-64h576v-216.96a32.64 32.64 0 0 1 19.2-29.44 32.64 32.64 0 0 1 33.92 5.76 64 64 0 1 0 0-94.72 31.36 31.36 0 0 1-33.92 5.76 32.64 32.64 0 0 1-19.2-29.44V288H519.04a32.64 32.64 0 0 1-29.44-19.2 31.36 31.36 0 0 1 5.76-33.92 64 64 0 1 0-94.72 0 31.36 31.36 0 0 1 5.76 33.92 32.64 32.64 0 0 1-29.44 19.2H160z",fill:"currentColor","p-id":"4275"})),Panel:function(){return n.createElement(Ge,{type:"multiple"},Ye.map((({componentCategory:e,title:t,components:s})=>n.createElement(Xe,{key:e,value:e},n.createElement(Qe,{className:"pt-2.5 hover:no-underline"},t),s.map((({componentName:t,title:s})=>{const{onDragStart:r,onDragEnd:a}=function(e,t){return{onDragStart:(0,n.useCallback)((s=>{s.stopPropagation(),s.dataTransfer.setData("type",h),s.dataTransfer.setData("componentName",e),R.dispatchAction({type:E}),R.dispatchAction({type:C,componentName:e,componentCategory:t})}),[e]),onDragEnd:(0,n.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),R.dispatchAction({type:_})}),[])}}(t,e),o=st[t];return n.createElement(et,{key:t,className:"h-10 px-2 flex items-center rounded-md hover:bg-s200 cursor-grab",onDragStart:r,draggable:!0,onDragEnd:a},n.createElement(o,null),n.createElement("span",null,s))}))))))},description:"组件库"},{type:"CNodeTreeLeft",Icon:()=>n.createElement("svg",{viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5550",width:"32",height:"32"},n.createElement("path",{d:"M576 682.666667H640v128h-213.333333v-128h64v-128H298.666667v128h42.666666v128H170.666667v-128h42.666666v-213.333334h277.333334V341.333333H426.666667V213.333333h213.333333v128h-64v128H853.333333v213.333334h42.666667v128h-170.666667v-128h42.666667v-128h-192v128z",fill:"currentColor","p-id":"5551"})),Panel:()=>n.createElement("div",null,"todo"),description:"组件树"}];function at(){const[e,t]=(0,n.useState)("CNodeDragLeft"),s=e=>()=>{t(e)};return n.createElement("div",{id:"left",className:U("basis-[300px] min-w-[300px] grow-0 shrink-0\n                bg-secondary border-[1px] border-solid\n                flex")},n.createElement("div",{className:"basis-[50px] grow-0 shrink-0 border-r-[1px] border-solid border-border\n                flex flex-col"},n.createElement(me,null,rt.map((({type:t,Icon:r,Panel:a,description:o})=>n.createElement(he,{key:t},n.createElement(ue,{onClick:s(t),className:"basis-[50px] p-[5px]"},n.createElement("div",{className:"w-full h-full flex justify-center items-center rounded-md",style:{backgroundColor:e===t?"var(--s300)":"transparent"}},n.createElement(r,null))),n.createElement(fe,{side:"right"},n.createElement("p",null,o))))))),n.createElement("div",{className:"h-full flex-auto overflow-y-auto p-[10px] pt-0"},rt.map((({type:t,Panel:s})=>e===t&&n.createElement(s,{key:t})))))}function ot({cNode:e}){const t=e.CNode_UI,[s,o]=(0,n.useState)(0);return(0,n.useEffect)((()=>{e.render=()=>o((e=>e+1))}),[]),(0,n.useEffect)((()=>{0===s&&e.lifeCycleRun(r)}),[s]),(0,n.useEffect)((()=>{s>0&&e.lifeCycleRun(a)}),[s]),n.createElement(t,{cNode:e},e.children.filter((e=>null!==e)).map((e=>n.createElement(ot,{key:e.id,cNode:e}))))}function nt(){const e=(0,n.useContext)(l);return n.createElement("div",{id:"center",className:U("grow shrink p-[8px] bg-s200 relative z-0"),style:{maxWidth:"calc(100% - 300px - 300px)"}},n.createElement(ot,{cNode:e.cNodeRoot}))}class it{selectedCNode;constructor(){this.selectedCNode=null,window.addEventListener(lt,{handleEvent:this.notify.bind(this)})}update_selectedCNode(e){e?this.selectedCNode=e:this.reset_selectedCNode()}reset_selectedCNode(){this.selectedCNode=null}display(){this.render()}}const lt="selectedCNodeChange",ct="selectedCNodeUpdate",dt="SettingProps",pt="SettingCssStyle",mt=new class extends it{render;tab;constructor(){super(),this.tab=dt}notify(e){const{selectedCNode:t}=e.detail;this.update_selectedCNode(t),this.tab=dt,this.display()}changeTab(e){this.tab=e,this.display()}},ht=new class extends it{render;constructor(){super()}notify(e){const{selectedCNode:t}=e.detail;this.update_selectedCNode(t)}};function ut(){const[e,t]=(0,n.useState)(0);(0,n.useEffect)((()=>{ht.render=()=>t((e=>e+1))}),[]);const{selectedCNode:s}=ht;if(!s)return null;const r=s.CNode_UI_Props;return n.createElement("div",{id:"settingProps",className:"h-full"},n.createElement(r,{key:s.id,cNode:s}))}var ft=s(48985);const gt=new class extends it{render;select_id;cssStyle_ori;cssEditor;contentFirstChange;constructor(){super(),this.select_id=null,this.cssStyle_ori=null,this.cssEditor=null,this.contentFirstChange=!1}notify(e){const{selectedCNode:t}=e.detail;this.update_selectedCNode(t),t?this.update(t):this.reset()}cssEditor_create(e){if(!this.selectedCNode)return;this.cssEditor_dispose();const t=this.cssStyle2str(this.selectedCNode.cssStyle);this.cssEditor=ft.EN.create(e,{value:t,language:"css",automaticLayout:!0}),this.cssEditor.onDidChangeModelContent((e=>{this.cssEditor&&(this.contentFirstChange||(this.contentFirstChange=!0,this.render()))}))}cssEditor_dispose(){this.cssEditor&&(this.cssEditor.dispose(),this.cssEditor=null)}update(e){this.reset(),this.select_id="#"+e.id,this.cssStyle_ori={...e.cssStyle_default},this.cssEditor=null}reset(){this.select_id=null,this.cssStyle_ori=null,this.cssEditor_dispose(),this.contentFirstChange=!1}css_reset(){this.cssEditor&&this.cssStyle_ori&&(this.cssEditor.setValue(this.cssStyle2str(this.cssStyle_ori)),R.dispatchAction({type:A,id:this.selectedCNode.id,cssStyle:{...this.cssStyle_ori}}),this.contentFirstChange=!1,this.render())}css_save(){if(!this.cssEditor||!this.selectedCNode)return;if(ft.EN.getModelMarkers({}).length)return B("css有语法错误"),this.contentFirstChange=!1,void this.render();const e=this.cssEditor.getValue().replace(/[\r\n\s]*/g,""),t=this.resolveCssStyle_firstLevel(e,this.select_id);this.cssEditor.setValue(this.cssStyle2str(t)),R.dispatchAction({type:A,id:this.selectedCNode.id,cssStyle:t}),this.contentFirstChange=!1,this.render()}cssStyle2str(e){const t=/[A-Z]/,s=[];for(const[r,a]of Object.entries(e))s.push(r.replace(t,(e=>"-"+e[0].toLowerCase())),":",a,";\n");return`${this.select_id}{\n${s.join("")}}`}resolveCssStyle_firstLevel(e,t){const s=[],r={},a=/-[a-z]/;function o(t,r){t>=r||e.substring(t,r+1).split(";").forEach((e=>{const t=e.split(":");2===t.length&&(t[0]=t[0].replace(a,(e=>e[1].toUpperCase())),s.push(t))}))}const n="{",i=e.length;let l=[],c=0,d=0,p="",m=0,h=!1;for(;d<i;){for(c=d,m=0,h=!1;d<i&&e[d]!==n;)d++;for(l.push(n),p=e.substring(c,d),d++,p===t&&(h=!0,m=d);l.length;)switch(e[d]){case n:h&&1===l.length&&o(m,d-1),l.push(n),d++;break;case"}":l.pop(),d++,h&&1===l.length&&(m=d);break;default:d++}h&&o(m,d-2)}for(let[e,t]of s)r[e]=t;return r}};function vt(){const[e,t]=(0,n.useState)(0);(0,n.useEffect)((()=>{gt.render=()=>t((e=>e+1))}),[]);const{selectedCNode:s}=gt;(0,n.useEffect)((()=>{if(!s)return;const e=document.querySelector("#settingCssStyle > #cssEditor");gt.cssEditor_create(e)}),[s&&s.id]);const r=(0,n.useCallback)((()=>{gt.css_save()}),[]),a=(0,n.useCallback)((()=>{gt.css_reset()}),[]);if(!s)return null;const{contentFirstChange:o}=gt;return n.createElement("div",{id:"settingCssStyle",className:"h-full"},n.createElement("div",{id:"cssEditor",className:"h-3/5"}),n.createElement("div",{className:"p-4 flex justify-between"},n.createElement(J,{onClick:a},"重置todo"),n.createElement(J,{disabled:!o,onClick:r},"保存")))}var Nt=s(5887);const bt=Nt.bL,yt=n.forwardRef((({className:e,...t},s)=>n.createElement(Nt.B8,{ref:s,className:U("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t})));yt.displayName=Nt.B8.displayName;const Et=n.forwardRef((({className:e,...t},s)=>n.createElement(Nt.l9,{ref:s,className:U("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t})));Et.displayName=Nt.l9.displayName;const wt=n.forwardRef((({className:e,...t},s)=>n.createElement(Nt.UC,{ref:s,className:U("h-full pt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t})));function Ct(){const[e,t]=(0,n.useState)(0);(0,n.useEffect)((()=>{mt.render=()=>t((e=>e+1))}),[]);const{selectedCNode:s,tab:r}=mt,a=(0,n.useCallback)((e=>()=>{mt.changeTab(e)}),[]);return s?n.createElement("div",{id:"settingRight",className:"h-full"},n.createElement(bt,{value:r,className:"h-full flex flex-col"},n.createElement(yt,{className:"w-full shadow-[0px_5px_2px_#94a3b8] flex-grow-0 flex-shrink-0"},n.createElement(Et,{className:"flex-grow",value:dt,onClick:a(dt)},"属性"),n.createElement(Et,{className:"flex-grow",value:pt,onClick:a(pt)},"样式")),n.createElement("div",{className:"p-3 flex-1 h-0"},n.createElement(wt,{value:dt},n.createElement(ut,null)),n.createElement(wt,{value:pt},n.createElement(vt,null))))):n.createElement("div",{className:"w-[150px] mx-auto mt-[60px] text-center text-secondary-foreground"},"请在画布中选中组件")}function xt(){return n.createElement("div",{id:"right",className:U("basis-[300px] min-w-[300px] grow-0 shrink-0\n                bg-secondary border-[1px] border-solid")},n.createElement(Ct,null))}wt.displayName=Nt.UC.displayName;const _t={box:{top:0,left:0},edge_borderWidth:2,edge_left:{width:0,height:0,top:0,left:0},edge_right:{width:0,height:0,top:0,left:0},edge_top:{width:0,height:0,top:0,left:0},edge_bottom:{width:0,height:0,top:0,left:0},tool:{where:"bottom",right:0,top:0}},kt=new class extends it{render;domRect;positionInfo;constructor(){super(),this.domRect=null,this.positionInfo=O(_t),window.addEventListener(ct,{handleEvent:this.notify_update.bind(this)})}notify(e){const{selectedCNode:t}=e.detail;this.update_selectedCNode(t),t?this.update(t):this.reset(),this.display()}notify_update(e){this.selectedCNode&&(this.update(this.selectedCNode),this.display())}update(e){this.domRect=e.ref.current.getBoundingClientRect(),this.positionInfo=O(_t),this.update_positionInfo()}update_positionInfo(){const{left:e,right:t,top:s,bottom:r,width:a,height:o}=this.domRect,{box:n,edge_borderWidth:i,edge_left:l,edge_right:c,edge_top:d,edge_bottom:p,tool:m}=this.positionInfo;n.top=s,n.left=e,l.width=i,l.height=o+2*i,l.top=-i,l.left=-i,c.width=i,c.height=o+2*i,c.top=-i,c.left=a,d.width=a+2*i,d.height=i,d.top=-i,d.left=-i,p.width=a+2*i,p.height=i,p.top=o,p.left=-i,m.right=-(a+i);const h=40+i+i/2,u=document.body.clientHeight,f=o+i+i/2;"bottom"===m.where&&r+h>u?(m.top=-h,m.where="top"):"top"===m.where&&s<h?(m.top=f,m.where="bottom"):0===m.top&&(m.top=f)}reset(){this.domRect=null}};function Dt(e){const[t,s]=(0,n.useState)(0);(0,n.useEffect)((()=>{kt.render=()=>s((e=>e+1))}),[]);const{selectedCNode:r,domRect:a}=kt,o=(0,n.useCallback)((()=>{r&&R.dispatchAction({type:y,id:r.parent.id})}),[r]),i=(0,n.useCallback)((()=>{r&&R.dispatchAction({type:f,copyId:r.id,parentId:r.parent.id,pos:r.pos+1})}),[r]),l=(0,n.useCallback)((()=>{r&&R.dispatchAction({type:v,id:r.id,prevParentId:r.parent.id,pos:r.pos})}),[r]);if(!r)return null;const{positionInfo:c}=kt,{box:d,edge_borderWidth:p,edge_left:m,edge_right:h,edge_top:u,edge_bottom:g,tool:N}=c;return n.createElement("div",{id:"cNodeSticker",className:"absolute z-10",style:{top:d.top,left:d.left}},n.createElement("div",{className:"border-solid border-CNodeSticker-border absolute",style:{borderLeftWidth:p,width:m.width,height:m.height,top:m.top,left:m.left}}),n.createElement("div",{className:"border-solid border-CNodeSticker-border absolute",style:{borderRightWidth:p,width:h.width,height:h.height,top:h.top,left:h.left}}),n.createElement("div",{className:"border-solid border-CNodeSticker-border absolute",style:{borderTopWidth:p,width:u.width,height:u.height,top:u.top,left:u.left}}),n.createElement("div",{className:"border-solid border-CNodeSticker-border absolute",style:{borderBottomWidth:p,width:g.width,height:g.height,top:g.top,left:g.left}}),"Root"!==r.componentName&&n.createElement("div",{className:"flex absolute bg-CNodeSticker-tool\n                      h-[40px]  p-[4px]",style:{top:N.top,right:N.right}},n.createElement(me,null,n.createElement(he,null,n.createElement(ue,{asChild:!0},n.createElement(J,{onClick:o,variant:"CNodeSticker-tool",size:"CNodeSticker-tool"},n.createElement("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4246",width:"24",height:"24"},n.createElement("path",{d:"M848.213333 416H576a21.333333 21.333333 0 0 0-21.333333 21.333333V981.333333a42.666667 42.666667 0 0 1-85.333334 0V437.333333a21.333333 21.333333 0 0 0-21.333333-21.333333H175.786667a21.333333 21.333333 0 0 1-15.786667-35.413333L495.786667 7.253333a21.333333 21.333333 0 0 1 31.573333 0l336.213333 373.333334a21.333333 21.333333 0 0 1-15.36 35.413333z",fill:"currentColor","p-id":"4247"})))),n.createElement(fe,null,n.createElement("p",null,"向上"))),n.createElement(he,null,n.createElement(ue,{asChild:!0},n.createElement(J,{onClick:i,variant:"CNodeSticker-tool",size:"CNodeSticker-tool"},n.createElement("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5835",id:"mx_n_1723105834229",width:"24",height:"24"},n.createElement("path",{d:"M891.072 822.144V167.36a34.432 34.432 0 0 0-34.432-34.432H201.856C201.856 94.848 232.704 64 270.784 64h620.288C929.152 64 960 94.848 960 132.928v620.288c0 38.08-30.848 68.928-68.928 68.928z m-68.928-551.36v620.288c0 38.08-30.848 68.928-68.928 68.928H132.928A68.928 68.928 0 0 1 64 891.072V270.784c0-38.08 30.848-68.928 68.928-68.928h620.288c38.08 0 68.928 30.848 68.928 68.928z m-137.856 137.856H201.856a34.432 34.432 0 0 0 0 68.864h482.432a34.432 34.432 0 0 0 0-68.864z m0 206.72H201.856a34.432 34.432 0 0 0 0 68.864h482.432a34.432 34.432 0 0 0 0-68.864z",fill:"currentColor","p-id":"5836"})))),n.createElement(fe,null,n.createElement("p",null,"复制"))),n.createElement(he,null,n.createElement(ue,{asChild:!0},n.createElement(J,{onClick:l,variant:"CNodeSticker-tool",size:"CNodeSticker-tool",className:"mr-0"},n.createElement("svg",{className:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6971",width:"24",height:"24"},n.createElement("path",{d:"M607.897867 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L575.903242 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 351.94087C639.892491 753.593818 625.61532 768.043004 607.897867 768.043004z",fill:"currentColor","p-id":"6972"}),n.createElement("path",{d:"M415.930119 768.043004c-17.717453 0-31.994625-14.277171-31.994625-31.994625L383.935495 383.935495c0-17.717453 14.277171-31.994625 31.994625-31.994625 17.717453 0 31.994625 14.277171 31.994625 31.994625l0 351.94087C447.924744 753.593818 433.647573 768.043004 415.930119 768.043004z",fill:"currentColor","p-id":"6973"}),n.createElement("path",{d:"M928.016126 223.962372l-159.973123 0L768.043004 159.973123c0-52.980346-42.659499-95.983874-95.295817-95.983874L351.94087 63.989249c-52.980346 0-95.983874 43.003528-95.983874 95.983874l0 63.989249-159.973123 0c-17.717453 0-31.994625 14.277171-31.994625 31.994625s14.277171 31.994625 31.994625 31.994625l832.032253 0c17.717453 0 31.994625-14.277171 31.994625-31.994625S945.73358 223.962372 928.016126 223.962372zM319.946246 159.973123c0-17.545439 14.449185-31.994625 31.994625-31.994625l320.806316 0c17.545439 0 31.306568 14.105157 31.306568 31.994625l0 63.989249L319.946246 223.962372 319.946246 159.973123 319.946246 159.973123z",fill:"currentColor","p-id":"6974"}),n.createElement("path",{d:"M736.048379 960.010751 288.123635 960.010751c-52.980346 0-95.983874-43.003528-95.983874-95.983874L192.139761 383.591466c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 480.435411c0 17.717453 14.449185 31.994625 31.994625 31.994625l448.096758 0c17.717453 0 31.994625-14.277171 31.994625-31.994625L768.215018 384.795565c0-17.717453 14.277171-31.994625 31.994625-31.994625s31.994625 14.277171 31.994625 31.994625l0 479.231312C832.032253 916.835209 789.028725 960.010751 736.048379 960.010751z",fill:"currentColor","p-id":"6975"})))),n.createElement(fe,null,n.createElement("p",null,"删除"))))))}const St=(0,c.Ys)([{path:"/",element:n.createElement((function(){const e=()=>{R.dispatchAction({type:w})};return(0,n.useEffect)((()=>(window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)})),[]),n.createElement("div",{id:"page-index",className:U("h-full flex flex-col")},n.createElement(Ae,null),n.createElement("div",{id:"body",className:U("flex"),style:{height:"calc(100% - 60px)"}},n.createElement(at,null),n.createElement(nt,null),n.createElement(xt,null)),n.createElement(Dt,null))}),null),errorElement:n.createElement((function(){return n.createElement("div",null,"这里是404")}),null)},{path:d,element:n.createElement((function(e){return(0,n.useEffect)((()=>{!async function(){const e=localStorage.getItem(W),t=localStorage.getItem(K);if(e&&t)return Y(+e)?void 0:(localStorage.removeItem(K),localStorage.removeItem(W),void B("预览页面过期"));B("预览失败")}()}),[]),n.createElement("div",null,"这里是预览页面 todo")}),null)}]);function Tt(){return n.createElement(c.pg,{router:St})}const zt=document.createElement("div");zt.setAttribute("id","root"),document.body.appendChild(zt);const At=(0,i.H)(zt);class It extends o{componentCategory;constructor(e,t,s,r){super(e,t,s,r),this.componentCategory="foundation"}}function Pt(e,t){const s=(0,n.useRef)({value:!0,checked:!1});return{onDragEnter:(0,n.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),s.current.value=!0,s.current.checked=!1}),[]),onDragOver:(0,n.useCallback)((r=>{r.stopPropagation(),e.isDropTarget||R.dispatchAction({type:x,id:e.id}),s.current.checked||!t||t(_s.drag_possible.componentName,_s.drag_possible.componentCategory)||(s.current.value=!1,s.current.checked=!0),s.current.value&&r.preventDefault()}),[]),onDrop:(0,n.useCallback)((t=>{t.stopPropagation(),t.preventDefault();const s=t.dataTransfer.getData("type");switch(s){case h:const r=t.dataTransfer.getData("componentName");R.dispatchAction({type:s,componentName:r,parentId:e.id,pos:e.children.length});break;case g:const a=t.dataTransfer.getData("id"),o=t.dataTransfer.getData("moveFromParentId"),n=+t.dataTransfer.getData("moveFromPos");R.dispatchAction({type:s,id:a,moveFromParentId:o,moveFromPos:n,moveToParentId:e.id,moveToPos:e.children.length});break;default:console.error("CNode_UI_DropAsChild中未处理的action type:",s)}R.dispatchAction({type:_})}),[]),canDrop:s}}function Rt({isDropTarget:e,canDrop:t,className:s}){if(!e)return null;const r=t?"var(--dropTargetTip)":"var(--dropTargetTip-ban)";return n.createElement(n.Fragment,null,n.createElement("div",{style:{borderTopColor:r},className:"absolute top-0 left-0 right-0 border-t-[4px] border-solid border-dropTargetTip"}),n.createElement("div",{style:{borderBottomColor:r},className:"absolute bottom-0 left-0 right-0 border-b-[4px] border-solid border-dropTargetTip"}),n.createElement("div",{style:{borderLeftColor:r},className:"absolute left-0 top-0 bottom-0 border-l-[4px] border-solid border-dropTargetTip"}),n.createElement("div",{style:{borderRightColor:r},className:"absolute right-0 top-0 bottom-0 border-r-[4px] border-solid border-dropTargetTip"}))}function Lt(e,t={enablePropagation:!1,enablePrevent:!1}){const{enablePropagation:s,enablePrevent:r}=t;return{onClick:(0,n.useCallback)((t=>{!s&&t.stopPropagation(),!r&&t.preventDefault(),R.dispatchAction({type:y,id:e.id})}),[])}}function Mt({cNode:e,children:t}){const{cssStyle:s}=e;(0,n.useEffect)((()=>{const e=()=>{R.dispatchAction({type:w})},t=document.querySelector("#scrollBox");return t.addEventListener("scroll",e,{passive:!0}),()=>{t.removeEventListener("scroll",e)}}),[]);const{onClick:r}=Lt(e),a=(0,n.useCallback)(((e,t)=>"layout"===t),[]),{onDragEnter:o,onDragOver:i,onDrop:l,canDrop:c}=Pt(e,a);return n.createElement("div",{id:e.id,ref:e.ref,style:{...s},className:"h-full bg-s200 relative",onClick:r,onDragEnter:o,onDragOver:i,onDrop:l},n.createElement("div",{id:"scrollBox",className:"h-full overflow-y-auto"},t),n.createElement(Rt,{isDropTarget:e.isDropTarget,canDrop:c.current.value}))}function Vt({cNode:e}){return n.createElement("div",{className:"flex flex-col"},n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"层级"),n.createElement("div",null,"根节点")))}class Ft extends o{componentCategory;constructor(e,t,s,r){super(e,t,s,r),this.componentCategory=We}}function Ut(e){return{onDragStart:(0,n.useCallback)((t=>{t.stopPropagation(),t.dataTransfer.setData("type",g),t.dataTransfer.setData("id",e.id),t.dataTransfer.setData("moveFromParentId",e.parent.id),t.dataTransfer.setData("moveFromPos",String(e.pos)),R.dispatchAction({type:E}),R.dispatchAction({type:C,componentName:e.componentName,componentCategory:e.componentCategory})}),[]),onDragEnd:(0,n.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),R.dispatchAction({type:_})}),[])}}function Ot({props:e,className:t,children:s}){const r=+e.columnNum,{regionName:a}=e;return n.createElement("div",{className:U("min-h-[70px]\n            border-[1px] border-dashed border-s500 bg-s300",t)},s?n.createElement(n.Fragment,null,n.createElement("div",{className:"h-6 leading-6 px-2 mt-2"},a),n.createElement("div",{className:"grid items-center p-[4px]",style:{gridTemplateColumns:`repeat(${r}, ${1/r*(100-2*(r-1))}%)`,gridAutoRows:"minmax(60px, auto)",gap:"2%"}},s)):n.createElement("div",{className:"h-[68px] flex justify-center items-center"},"表单块：待拖入其他表单组件"))}function Ht({cNode:e,children:t}){const{props:{widthRadio:s,columnNum:r},cssStyle:a}=e,{onClick:o}=Lt(e),i=(0,n.useCallback)(((e,t)=>"form"===t),[]),{onDragEnter:l,onDragOver:c,onDrop:d,canDrop:p}=Pt(e,i),{onDragStart:m,onDragEnd:h}=Ut(e);return n.createElement("div",{id:e.id,ref:e.ref,style:{width:s,flexBasis:s,...a},className:"my-[4px] first:mt-0 last:mb-0 relative",onClick:o,onDragEnter:l,onDragOver:c,onDrop:d,onDragStart:m,draggable:!0,onDragEnd:h},n.createElement(Ot,{children:t.length?t:null,props:{...e.props}}),n.createElement(Rt,{isDropTarget:e.isDropTarget,canDrop:p.current.value}))}var Bt=s(96925),jt=s(72102);const Jt=Bt.bL,$t=Bt.YJ,Kt=Bt.WT,Wt=n.forwardRef((({className:e,children:t,...s},r)=>n.createElement(Bt.l9,{ref:r,className:U("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...s},t,n.createElement(Bt.In,{asChild:!0},n.createElement(qe.A,{className:"h-4 w-4 opacity-50"})))));Wt.displayName=Bt.l9.displayName;const Yt=n.forwardRef((({className:e,...t},s)=>n.createElement(Bt.PP,{ref:s,className:U("flex cursor-default items-center justify-center py-1",e),...t},n.createElement(jt.A,{className:"h-4 w-4"}))));Yt.displayName=Bt.PP.displayName;const Zt=n.forwardRef((({className:e,...t},s)=>n.createElement(Bt.wn,{ref:s,className:U("flex cursor-default items-center justify-center py-1",e),...t},n.createElement(qe.A,{className:"h-4 w-4"}))));Zt.displayName=Bt.wn.displayName;const qt=n.forwardRef((({className:e,children:t,position:s="popper",...r},a)=>n.createElement(Bt.ZL,null,n.createElement(Bt.UC,{ref:a,className:U("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===s&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:s,...r},n.createElement(Yt,null),n.createElement(Bt.LM,{className:U("p-1","popper"===s&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]")},t),n.createElement(Zt,null)))));qt.displayName=Bt.UC.displayName;const Gt=n.forwardRef((({className:e,...t},s)=>n.createElement(Bt.JU,{ref:s,className:U("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t})));Gt.displayName=Bt.JU.displayName;const Xt=n.forwardRef((({className:e,children:t,...s},r)=>n.createElement(Bt.q7,{ref:r,className:U("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...s},n.createElement("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center"},n.createElement(Bt.VF,null,n.createElement(ve.A,{className:"h-4 w-4"}))),n.createElement(Bt.p4,null,t))));function Qt(e){const{options:t,defaultValue:s,placeholder:r,className:a,onValueChange:o}=e;return n.createElement(Jt,{defaultValue:s,onValueChange:o},n.createElement(Wt,{className:a},n.createElement(Kt,{placeholder:r})),n.createElement(qt,null,n.createElement($t,null,t.length?t.map((({value:e,text:t})=>n.createElement(Xt,{key:e,value:e},t))):n.createElement(Gt,null,"无内容"))))}function es(e,t){return{onChange:(0,n.useCallback)((s=>{R.dispatchAction({type:S,id:e.id,prop:t,value:s})}),[e.id])}}Xt.displayName=Bt.q7.displayName,n.forwardRef((({className:e,...t},s)=>n.createElement(Bt.wv,{ref:s,className:U("-mx-1 my-1 h-px bg-muted",e),...t}))).displayName=Bt.wv.displayName;const ts=n.forwardRef((({className:e,type:t,...s},r)=>n.createElement("input",{type:t,className:U("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s})));function ss(e,t){return{onChange:(0,n.useCallback)((s=>{R.dispatchAction({type:S,id:e.id,prop:t,value:s.target.value})}),[e.id])}}function rs({cNode:e}){const t=e.props,{widthRadio:s,columnNum:r,regionName:a}=t,{onChange:o}=es(e,He),{onChange:i}=es(e,je),{onChange:l}=ss(e,$e);return n.createElement("div",{className:"flex flex-col"},n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"表单块"),n.createElement(ts,{defaultValue:a,onChange:l})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"宽度占比"),n.createElement(Qt,{options:Ke[He],defaultValue:s,onValueChange:o})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"列数量"),n.createElement(Qt,{options:Ke[je],defaultValue:r,onValueChange:i})))}ts.displayName="Input";class as extends o{componentCategory;constructor(e,t,s,r){super(e,t,s,r),this.componentCategory=Ie}}function os(e,t){const s=(0,n.useRef)(),r=(0,n.useRef)({value:!0,checked:!1}),a=(0,n.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),s.current=e.currentTarget.getBoundingClientRect(),r.current.value=!0,r.current.checked=!1}),[]),o=(0,n.useRef)(!0);return{onDragEnter:a,onDragOver:(0,n.useCallback)((a=>{a.stopPropagation();const{clientX:n,clientY:i}=a,{height:l,width:c,left:d,bottom:p}=s.current,m=i<=-l/c*(n-d)+p;e.isDropTarget&&m===o.current||(o.current=m,R.dispatchAction({type:x,id:e.id})),r.current.checked||!t||t(_s.drag_possible.componentName,_s.drag_possible.componentCategory)||(r.current.value=!1,r.current.checked=!0),r.current.value&&a.preventDefault()}),[]),onDrop:(0,n.useCallback)((t=>{t.stopPropagation(),t.preventDefault();const s=t.dataTransfer.getData("type");switch(s){case h:const r=t.dataTransfer.getData("componentName");R.dispatchAction({type:s,componentName:r,parentId:e.parent.id,pos:o.current?e.pos:e.pos+1});break;case g:const a=t.dataTransfer.getData("id"),n=t.dataTransfer.getData("moveFromParentId"),i=+t.dataTransfer.getData("moveFromPos");R.dispatchAction({type:s,id:a,moveFromParentId:n,moveFromPos:i,moveToParentId:e.parent.id,moveToPos:o.current?e.pos:e.pos+1});break;default:console.error("CNode_UI_DropAsSibling中未处理的action type:",s)}R.dispatchAction({type:_})}),[]),canDrop:r,dropLeftRef:o}}function ns({isDropTarget:e,canDrop:t,isDropLeft:s,className:r}){if(!e)return null;const a=t?"var(--dropTargetTip)":"var(--dropTargetTip-ban)";return n.createElement(n.Fragment,null,s?n.createElement("div",{className:"absolute left-0 top-0 bottom-0 border-l-[4px] border-solid",style:{borderLeftColor:a}}):n.createElement("div",{className:"absolute right-0 top-0 bottom-0 border-r-[4px] border-solid",style:{borderRightColor:a}}))}function is({props:e,className:t}){const{fieldKey:s,fieldLabel:r,fieldPlaceholder:a}=e;return n.createElement("div",{className:U("flex items-center\n            h-[50px] p-[4px]\n            border-[2px] border-solid border-s400 rounded-md",t)},n.createElement("div",{className:"flex-grow-0 flex-shrink-1 basis-[100px] flex justify-center items-center break-all"},r),n.createElement("div",{className:"flex-grow-0 flex-shrink-1 basis-[200px]"},n.createElement(ts,{placeholder:a})))}function ls({cNode:e}){const{props:t,cssStyle:s}=e,{onClick:r}=Lt(e),a=(0,n.useCallback)(((e,t)=>"form"===t),[]),{onDragEnter:o,onDragOver:i,onDrop:l,canDrop:c,dropLeftRef:d}=os(e,a),{onDragStart:p,onDragEnd:m}=Ut(e);return n.createElement("div",{id:e.id,ref:e.ref,style:{...s},className:"max-w-[300px] bg-s200 relative",onClick:r,onDragEnter:o,onDragOver:i,onDrop:l,onDragStart:p,draggable:!0,onDragEnd:m},n.createElement(is,{props:{...t}}),n.createElement(ns,{isDropTarget:e.isDropTarget,canDrop:c.current.value,isDropLeft:d.current}))}function cs({cNode:e}){const t=e.props,{fieldKey:s,fieldLabel:r,fieldPlaceholder:a}=t,{onChange:o}=ss(e,Ve.fieldKey),{onChange:i}=ss(e,Ve.fieldLabel),{onChange:l}=ss(e,Ve.fieldPlaceholder);return n.createElement("div",{className:"flex flex-col"},n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"字段key"),n.createElement(ts,{defaultValue:s,onChange:o})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"字段label"),n.createElement(ts,{defaultValue:r,onChange:i})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"占位值"),n.createElement(ts,{defaultValue:a,onChange:l})))}function ds({props:e,className:t}){const{fieldKey:s,fieldLabel:r,fieldPlaceholder:a}=e;return n.createElement("div",{className:U("flex items-center\n            h-[50px] p-[4px]\n            border-[2px] border-solid border-s400 rounded-md",t)},n.createElement("div",{className:"flex-grow-0 flex-shrink-1 basis-[100px] flex justify-center items-center break-all"},r),n.createElement("div",{className:"flex-grow-0 flex-shrink-1 basis-[200px]"},n.createElement(Jt,null,n.createElement(Wt,null,n.createElement(Kt,{placeholder:a})),n.createElement(qt,null,n.createElement($t,null,n.createElement(Gt,null,"选项："),n.createElement(Xt,{value:"1"},"选项1"),n.createElement(Xt,{value:"2"},"选项2"))))))}function ps({cNode:e}){const{props:t,cssStyle:s}=e,{onClick:r}=Lt(e),a=(0,n.useCallback)(((e,t)=>"form"===t),[]),{onDragEnter:o,onDragOver:i,onDrop:l,canDrop:c,dropLeftRef:d}=os(e,a),{onDragStart:p,onDragEnd:m}=Ut(e);return n.createElement("div",{id:e.id,ref:e.ref,style:{...s},className:"max-w-[300px] bg-s200 relative",onClick:r,onDragEnter:o,onDragOver:i,onDrop:l,onDragStart:p,draggable:!0,onDragEnd:m},n.createElement(ds,{props:{...t}}),n.createElement(ns,{isDropTarget:e.isDropTarget,canDrop:c.current.value,isDropLeft:d.current}))}function ms({cNode:e}){const t=e.props,{fieldKey:s,fieldLabel:r,fieldPlaceholder:a}=t,{onChange:o}=ss(e,Ue.fieldKey),{onChange:i}=ss(e,Ue.fieldLabel),{onChange:l}=ss(e,Ue.fieldPlaceholder);return n.createElement("div",{className:"flex flex-col"},n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"字段key"),n.createElement(ts,{defaultValue:s,onChange:o})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"字段label"),n.createElement(ts,{defaultValue:r,onChange:i})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"占位提示"),n.createElement(ts,{defaultValue:a,onChange:l})))}var hs=s(95920);const us=(0,M.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),fs=n.forwardRef((({className:e,...t},s)=>n.createElement(hs.b,{ref:s,className:U(us(),e),...t})));function gs({props:e,className:t}){const{fieldKey:s,fieldLabel:r,fieldPlaceholder:a}=e;return n.createElement("div",{className:U("flex items-center\n            h-[50px] p-[4px]\n            border-[2px] border-solid border-s400 rounded-md",t)},n.createElement("div",{className:"flex-grow-0 flex-shrink-1 basis-[100px] flex justify-center items-center break-all"},r),n.createElement("div",{className:"flex-grow-0 flex-shrink-1 basis-[200px]"},n.createElement(fs,{htmlFor:`upload-${s}`,className:"self-stretch flex items-center"},a),n.createElement(ts,{id:`upload-${s}`,type:"file",style:{display:"none"}})))}function vs({cNode:e}){const{props:t,cssStyle:s}=e,{onClick:r}=Lt(e,{enablePrevent:!0}),a=(0,n.useCallback)(((e,t)=>"form"===t),[]),{onDragEnter:o,onDragOver:i,onDrop:l,canDrop:c,dropLeftRef:d}=os(e,a),{onDragStart:p,onDragEnd:m}=Ut(e);return n.createElement("div",{id:e.id,ref:e.ref,style:{...s},className:"max-w-[300px] bg-s200 relative",onClick:r,onDragEnter:o,onDragOver:i,onDrop:l,onDragStart:p,draggable:!0,onDragEnd:m},n.createElement(gs,{props:{...t}}),n.createElement(ns,{isDropTarget:e.isDropTarget,canDrop:c.current.value,isDropLeft:d.current}))}function Ns({cNode:e}){const t=e.props,{fieldKey:s,fieldLabel:r,fieldPlaceholder:a}=t,{onChange:o}=ss(e,Le.fieldKey),{onChange:i}=ss(e,Le.fieldLabel),{onChange:l}=ss(e,Le.fieldPlaceholder);return n.createElement("div",{className:"flex flex-col"},n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"字段key"),n.createElement(ts,{defaultValue:s,onChange:o})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"字段label"),n.createElement(ts,{defaultValue:r,onChange:i})),n.createElement("div",{className:"basis-[50px] flex items-center"},n.createElement("div",{className:"grow-0 shrink-0 basis-20 flex items-center"},"占位提示"),n.createElement(ts,{defaultValue:a,onChange:l})))}fs.displayName=hs.b.displayName;const bs={[tt]:class extends It{componentName;title;isDraggable;isDroppable;isDropTarget;props;cssStyle;cssStyle_default;constructor(e,t,s,r){super(e,t,s,r),this.isDraggable=!1,this.isDroppable=!0,this.isDropTarget=!1,this.componentName=tt,this.title="根",this.props={},this.cssStyle={},this.cssStyle_default={...this.cssStyle}}get CNode_UI(){return Mt}get CNode_UI_Props(){return Vt}},[Oe.componentName]:class extends Ft{componentName;title;isDraggable;isDroppable;isDropTarget;props;cssStyle;cssStyle_default;constructor(e,t,s,r){super(e,t,s,r),this.isDraggable=!0,this.isDroppable=!0,this.isDropTarget=!1,this.componentName=Oe.componentName,this.title=Oe.title,this.props={[He]:"100%",[Be]:"100%",[je]:"2",[Je]:"2",[$e]:`基本信息-${e}`},this.cssStyle={},this.cssStyle_default={...this.cssStyle},this.lifeCycleRegister("afterDomUpdated",(()=>this.props.widthRadio_prev!==this.props.widthRadio?(this.props.widthRadio_prev=this.props.widthRadio,void R.dispatchAction({type:w})):this.props.columnNum_prev!==this.props.columnNum?(this.props.columnNum_prev=this.props.columnNum,void R.dispatchAction({type:w})):void 0))}get CNode_UI(){return Ht}get CNode_UI_Props(){return rs}},[Me.componentName]:class extends as{componentName;title;isDraggable;isDroppable;isDropTarget;props;cssStyle;cssStyle_default;constructor(e,t,s,r){super(e,t,s,r),this.isDraggable=!0,this.isDroppable=!0,this.isDropTarget=!1,this.componentName=Me.componentName,this.title=Me.title,this.props={[Ve.fieldKey]:`field-${e}`,[Ve.fieldLabel]:`字段-${e}`,[Ve.fieldPlaceholder]:`${Me.title}-${e}`},this.cssStyle={},this.cssStyle_default={...this.cssStyle}}get CNode_UI(){return ls}get CNode_UI_Props(){return cs}},[Fe.componentName]:class extends as{componentName;title;isDraggable;isDroppable;isDropTarget;props;cssStyle;cssStyle_default;constructor(e,t,s,r){super(e,t,s,r),this.isDraggable=!0,this.isDroppable=!0,this.isDropTarget=!1,this.componentName=Fe.componentName,this.title=Fe.title,this.props={[Ue.fieldKey]:`field-${e}`,[Ue.fieldLabel]:`字段-${e}`,[Ue.fieldPlaceholder]:"请选择"},this.cssStyle={},this.cssStyle_default={...this.cssStyle}}get CNode_UI(){return ps}get CNode_UI_Props(){return ms}},[Re.componentName]:class extends as{componentName;title;isDraggable;isDroppable;isDropTarget;props;cssStyle;cssStyle_default;constructor(e,t,s,r){super(e,t,s,r),this.isDraggable=!0,this.isDroppable=!0,this.isDropTarget=!1,this.componentName=Re.componentName,this.title=Re.title,this.props={[Le.fieldKey]:`field-${e}`,[Le.fieldLabel]:`字段-${e}`,[Le.fieldPlaceholder]:"选择文件"},this.cssStyle={},this.cssStyle_default={...this.cssStyle}}get CNode_UI(){return vs}get CNode_UI_Props(){return Ns}}};function ys(e,t){const s=new Map;return function e(r){let a=null;if(Array.isArray(r)){if(s.has(r))return r;a=[],s.set(r,a),r.forEach(((t,s)=>{a[s]=e(t)}))}else if("object"==typeof r&&null!==r){if(s.has(r))return r;a={},s.set(r,a),Object.getOwnPropertyNames(r).forEach((t=>{a[t]=e(r[t])})),Object.getOwnPropertySymbols(r).forEach((t=>{let s=Symbol.keyFor(t);void 0!==s?a[Symbol.for(s)]=e(r[t]):(s=t.description,a[Symbol(s)]=e(r[t]))}))}else if("symbol"==typeof r){let e=Symbol.keyFor(r);a=void 0!==e?Symbol.for(e):Symbol(e),t.push(a)}else"function"==typeof r?a=r:(a=r,t.push(a));return a}(e)}class Es{static cNodeMap=new Map;static getCNode(e){return this.cNodeMap.get(e)}static setCNode(e,t){this.cNodeMap.set(e,t)}root;renderCNodes;constructor(){this.root=this.produce("Root"),this.renderCNodes=[]}produce(e,t){t=t||String(m.gene());const s=new bs[e](t,null,-1,[]);return xs.setCNode(t,s),s}clone(e,t){const s=this.produce(e.componentName,t);return Object.assign(s,{props:O(e.props),cssStyle:O(e.cssStyle)}),s}clone_tree(e,t){const s=this.clone(e,t);return e.children.forEach(((e,t)=>{s.children[t]=e?this.clone_tree(e):null})),s}alter_appendAsChild(e,t,s=e.pos){if(e.parent=t,s<0)t.children.push(e),e.pos=t.children.length-1;else{if(t.children[s]){t.children.splice(s,0,e);for(let e=s+1;e<t.children.length;e++)t.children[e]&&(t.children[e].pos=e)}else t.children[s]=e;e.pos=s}return t}alter_appendAsNext(e,t){if(!t.parent)throw"alter_appendAsNext出错 -> parent为空";return this.alter_appendAsChild(e,t.parent,t.pos+1)}alter_appendAsPrev(e,t){if(!t.parent)throw"alter_appendAsPrev出错 -> parent为空";return this.alter_appendAsChild(e,t.parent,t.pos)}alter_delete(e){const t=e.parent;if(!t)throw"alter_delete出错 -> parent为空";return t.children[e.pos]=null,e.parent=null,e.pos=-1,t}AisAncestorB(e,t){let s=t;for(;s;){if(s===e)return!0;s=s.parent}return!1}toRender(...e){this.renderCNodes.push(...e)}render(){this.renderCNodes.forEach((e=>{e.render()})),this.renderCNodes.length=0}}class ws extends Es{drag_possible;drop_target_cNode;selectedCNode;constructor(){super(),this.drag_possible={componentName:null,componentCategory:null},this.drop_target_cNode=null,this.selectedCNode=null}receiveActionCNode(e){switch(e.type){case h:{const{componentName:t,id:s,parentId:r,pos:a}=e,o=this.produce(t,s),n=xs.getCNode(r);this.alter_appendAsChild(o,n,a),this.toRender(n),this.render()}break;case u:{const{id:t,parentId:s,pos:r}=e,a=xs.getCNode(t),o=xs.getCNode(s);this.alter_appendAsChild(a,o,r),this.toRender(o),this.render()}break;case f:{const{id:t,copyId:s,parentId:a,pos:o}=e,n=xs.getCNode(s),i=xs.getCNode(a),l=this.clone_tree(n,t);this.alter_appendAsChild(l,i,o),this.toRender(i),this.render(),l.lifeCycleRegister(r,(()=>this.receiveActionTip({type:y,id:l.id})))}break;case g:{const{id:t,moveFromParentId:s,moveFromPos:r,moveToParentId:a,moveToPos:o}=e,n=xs.getCNode(t),i=xs.getCNode(a);if(this.AisAncestorB(n,i))return;this.toRender(this.alter_delete(n),this.alter_appendAsChild(n,i,o)),this.render()}break;case v:{const{id:t,prevParentId:s,pos:r}=e,a=xs.getCNode(t);this.toRender(this.alter_delete(a)),this.receiveActionTip({type:E}),this.render()}break;default:throw"receiveActionCNode出错"}}receiveActionTip(e){switch(e.type){case y:{const{id:t}=e,s=xs.getCNode(t);if(this.selectedCNode&&this.selectedCNode.id===s.id)return;this.selectedCNode=s,this.toRender(this.selectedCNode),this.render(),window.dispatchEvent(new CustomEvent(lt,{detail:{selectedCNode:this.selectedCNode}}))}break;case E:this.selectedCNode=null,window.dispatchEvent(new CustomEvent(lt,{detail:{selectedCNode:this.selectedCNode}}));break;case w:window.dispatchEvent(new CustomEvent(ct,{detail:{selectedCNode:this.selectedCNode}}));break;case C:{const{componentName:t,componentCategory:s}=e;this.drag_possible.componentName=t,this.drag_possible.componentCategory=s}break;case x:{const{id:t}=e;this.drop_target_cNode&&(this.drop_target_cNode.isDropTarget=!1,this.toRender(this.drop_target_cNode)),this.drop_target_cNode=xs.getCNode(t),this.drop_target_cNode.isDropTarget=!0,this.toRender(this.drop_target_cNode),this.render()}break;case _:this.drag_possible.componentName=null,this.drag_possible.componentCategory=null,this.drop_target_cNode&&(this.drop_target_cNode.isDropTarget=!1,this.toRender(this.drop_target_cNode),this.drop_target_cNode=null,this.render())}}receiveActionCNodeProps(e){if(e.type===S){const{id:t,prop:s,value:r}=e,a=xs.getCNode(t);a.props[s]=r,this.toRender(a),this.render()}}receiveActionCNodeCssStyle(e){if(e.type===A){const{id:t,cssStyle:s}=e,r=xs.getCNode(t);r.cssStyle=s,this.toRender(r),this.render()}}}class Cs extends ws{constructor(){super()}to_cNode_JSON(e,t){const s={id:e.id,componentCategory:e.componentCategory,componentName:e.componentName,title:e.title};return t.push(e.id,e.componentCategory,e.componentName,e.title),s.props=ys(e.props,t),s.cssStyle=ys(e.cssStyle,t),s.children=e.children.filter((e=>null!==e)).map((e=>this.to_cNode_JSON(e,t))),s}async getCNodeTreeJSON(){const e=[];return{cNodeTree_JSON:this.to_cNode_JSON(this.root,e),cNodeTree_hash:await async function(e){try{const t=+Date.now();let s=e.join("")+t;const r=(new TextEncoder).encode(s),a=await window.crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("")}catch(e){throw"digestMessage出错 ->"+e}}(e)}}}class xs extends Cs{constructor(){super()}create_baseView(){const e=this.produce("FormBlock"),t=this.produce("Input");this.alter_appendAsChild(t,e);const s=this.produce("FormBlock");this.alter_appendAsChild(e,this.root),this.alter_appendAsChild(s,this.root)}bootstrap(){var e;this.create_baseView(),e=this.root,console.log("节点树",e),At.render(n.createElement(l.Provider,{value:{cNodeRoot:e}},n.createElement(Tt,null)))}}const _s=new xs;_s.bootstrap()}},e=>{e.O(0,[96],(()=>e(e.s=62299))),e.O()}]);